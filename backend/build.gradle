plugins {
    id "java"
    id "idea"
    id "org.springframework.boot" version "2.5.6"
    id "io.spring.dependency-management" version "1.0.11.RELEASE"
    id "io.freefair.lombok" version "6.3.0"
    id "com.github.spotbugs" version "4.8.0"
    id "com.github.sherter.google-java-format" version "0.9"
    id "jacoco"
    id "com.github.ben-manes.versions" version "0.39.0"
    id "org.owasp.dependencycheck" version "6.5.0.1"
}

jacoco {
    toolVersion = "0.8.7"
}

googleJavaFormat {
    toolVersion = "1.13.0"
}

lombok {
    version = "1.18.22"
    config["lombok.anyConstructor.addConstructorProperties"] = "true"
}

ext {
    jacksonDataBindVersion = "2.13.0"
    javaUuidGeneratorVersion = "4.0.1"
    logstashVersion = "7.0"
    caffeineVersion = "3.0.4"
    wiremockVersion = "2.27.2"
    archUnitVersion = "0.22.0"
}

repositories {
    mavenCentral()
}

bootJar {
    archiveFileName = "${archiveBaseName.get()}.${archiveExtension.get()}"
}

dependencies {
    implementation "org.springframework.boot:spring-boot-starter-web"
    implementation "org.springframework.boot:spring-boot-starter-cache"
    implementation "org.springframework.boot:spring-boot-starter-actuator"
    implementation "com.fasterxml.jackson.core:jackson-core:${jacksonDataBindVersion}"
    implementation "com.fasterxml.jackson.core:jackson-databind:${jacksonDataBindVersion}"
    implementation "com.fasterxml.uuid:java-uuid-generator:${javaUuidGeneratorVersion}"
    implementation "net.logstash.logback:logstash-logback-encoder:${logstashVersion}"
    implementation "com.github.ben-manes.caffeine:caffeine:${caffeineVersion}"

    testImplementation("org.springframework.boot:spring-boot-starter-test") {
        exclude group: "org.junit.vintage", module: "junit-vintage-engine"
    }
    testImplementation "com.github.tomakehurst:wiremock:${wiremockVersion}"
    testImplementation "com.tngtech.archunit:archunit-junit5:${archUnitVersion}"
}

group = "de.otto.platform"
sourceCompatibility = 11
targetCompatibility = 11

tag {
    message fromMandatorySystemProperty('message')
}

apply from: "${rootDir}/gradle/test.gradle"
apply from: "${rootDir}/gradle/spotbugs.gradle"
apply from: "${rootDir}/gradle/dependencycheck.gradle"
apply from: "${rootDir}/gradle/checkstyle.gradle"
